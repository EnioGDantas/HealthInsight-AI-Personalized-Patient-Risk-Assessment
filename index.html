<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Health Platform</title>
  <style>
    /* Estilos completos do prot√≥tipo original */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
    }
    
    header {
      background: linear-gradient(135deg, #1e5799 0%, #207cca 100%);
      color: white;
      padding: 2rem 0;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .how {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-top: -50px;
      position: relative;
      z-index: 1;
    }
    
    .button {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .button:hover {
      background: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .container {
      max-width: 900px;
      margin: 2rem auto;
      padding: 0;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      overflow: hidden;
      display: none;
    }
    
    .chat-area {
      display: flex;
      flex-direction: column;
      height: 600px;
    }
    
    .messages-container {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background-color: #f9f9f9;
    }
    
    .chat-message {
      margin-bottom: 15px;
      padding: 12px 16px;
      border-radius: 18px;
      max-width: 70%;
      position: relative;
      animation: fadeIn 0.3s ease;
    }
    
    .chat-message.user {
      background-color: #e3f2fd;
      margin-left: auto;
      border-bottom-right-radius: 4px;
    }
    
    .chat-message.assistant {
      background-color: #f1f1f1;
      margin-right: auto;
      border-bottom-left-radius: 4px;
    }
    
    .input-area {
      display: flex;
      padding: 15px;
      background-color: white;
      border-top: 1px solid #eee;
    }
    
    .input-field {
      flex: 1;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      resize: none;
      font-size: 16px;
      min-height: 50px;
    }
    
    .input-area button {
      margin-left: 10px;
      background: #4CAF50;
      color: white;
      border: none;
      padding: 0 24px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
    }
    
    .form-container {
      max-width: 700px;
      margin: 3rem auto;
      padding: 30px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    
    .form {
      width: 100%;
      padding: 12px;
      margin-bottom: 20px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }
    
    .textarea-form {
      height: 150px;
      resize: vertical;
    }
    
    .button-send {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .button-send:hover {
      background: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Adicionais para o formul√°rio de contato */
    .status-message {
      margin-top: 20px;
      padding: 12px;
      border-radius: 4px;
      display: none;
      animation: fadeIn 0.3s ease;
    }
    
    .success {
      background-color: #d4edda;
      color: #155724;
      display: block;
    }
    
    .error {
      background-color: #f8d7da;
      color: #721c24;
      display: block;
    }
  </style>
</head>
<body>
  <header>
    <h1>AI Health Platform Prototype</h1>
    <div class="how">
      <h2>How It Works</h2>
      <p>
        HealthInsight AI uses cutting-edge Artificial Intelligence technology to provide personalized risk
        assessments for patients, identifying potential health risks early on. By utilizing public health data, the
        platform offers accurate predictions based on a patient's age, medical condition, and other critical factors.
      </p>
      <button class="button" onclick="showPlatform()">Try It Now</button>
    </div>
  </header>

  <div class="container" id="platformContainer">
    <div class="chat-area" id="chatArea">
      <div id="chatMessages" class="messages-container"></div>
      <form class="input-area">
        <textarea class="input-field" id="messageInput" placeholder="Type your message here..." rows="2"></textarea>
        <button type="submit">Send</button>
      </form>
    </div>
  </div>

  <div class="form-container">
    <h2>Interested in Collaborating?</h2>
    <p>If you are part of a hospital, health startup, or institution that would like to partner with us and help us further develop HealthInsight AI, please fill out the contact form below.</p>
    <form id="contactForm">
      <input class="form" type="text" name="name" placeholder="Your Name" required>
      <input class="form" type="email" name="email" placeholder="Your Email" required>
      <textarea class="textarea-form form" name="message" placeholder="Your Message" required></textarea>
      <button class="button-send" type="submit">Submit</button>
      <div id="statusMessage" class="status-message"></div>
    </form>
  </div>

  <script>
    // Fun√ß√£o para mostrar a plataforma
    function showPlatform() {
      const container = document.getElementById('platformContainer');
      container.style.display = 'block';
      container.scrollIntoView({ behavior: 'smooth' });
      // Inicia o chat
      displayAssistantMessage(questions[currentQuestion]);
    }

    // Elementos do chat
    const chatMessages = document.getElementById("chatMessages");
    const messageInput = document.getElementById("messageInput");
    const inputForm = document.querySelector(".input-area");

    // Perguntas do fluxo do chat
    let questions = [
      "Hello! üëã<br><br>I am your AI Health Assistant. I'm here to collect some information about the patient. Shall we begin? (yes/no)",
      "Please enter the patient's full name:",
      "Please enter the patient's age:",
      "Please enter the patient's gender (male/female/other):",
      "Please enter the patient's height (in cm):",
      "Please enter the patient's weight (in kg):",
      "Please enter the patient's ethnicity:<br>1 - White<br>2 - Black or African American<br>3 - Asian<br>4 - Hispanic or Latino<br>5 - Native American or Alaska Native<br>6 - Native Hawaiian or Other Pacific Islander<br>7 - Other (please specify)",
      "Thank you for the initial information.<br><br>Now let's move on to the patient's medical history. Ready? (yes/no)",
      "What is the patient's family history of chronic diseases?",
      "Please list the patient's personal medical history:",
      "Is the patient currently taking any medications? If yes, please list them:",
      "Does the patient have any known allergies? (e.g., penicillin, peanuts, dust mites, etc.)",
      "Please list any previous surgeries the patient has undergone:",
      "Thank you! Now let's continue with the patient's lifestyle and daily habits. Type \"ok\" to continue:",
      "What is the patient's level of physical activity? (e.g., sedentary, moderate, active)",
      "Describe the patient's usual diet (e.g., vegetarian, omnivore, specific dietary preferences):",
      "How often does the patient consume alcohol, and in what quantity? (e.g., '2 beers per week' or '1 glass of wine daily')",
      "Does the patient smoke? If yes, please specify frequency and quantity: (e.g., '10 cigarettes per day' or 'occasional cigar')",
      "Thanks! Now let's collect some biometric data. Type \"ok\" when ready:",
      "Please enter the patient's blood pressure level (e.g., 120/80 mmHg):",
      "Please enter the patient's cholesterol level:",
      "Please enter the patient's glucose level:",
      "Please enter the patient's abdominal circumference (in cm):",
      "Would you like to see the results based on the information provided? (yes/no)"
    ];

    // Vari√°veis de estado
    let currentQuestion = 0;
    const answers = [];
    let emailRequested = false;
    let evaluationComplete = false;

    // Fun√ß√µes do chat
    function displayUserMessage(text) {
      const message = document.createElement("div");
      message.className = "chat-message user";
      message.innerHTML = `<p>${text}</p>`;
      chatMessages.appendChild(message);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function displayAssistantMessage(text) {
      const message = document.createElement("div");
      message.className = "chat-message assistant";
      message.innerHTML = `<p>${text}</p>`;
      chatMessages.appendChild(message);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function displayTyping(callback) {
      const typing = document.createElement("div");
      typing.className = "chat-message assistant typing";
      typing.innerHTML = "<p>AI Assistant is typing...</p>";
      chatMessages.appendChild(typing);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      setTimeout(() => {
        typing.remove();
        callback();
      }, 1000);
    }

    function analyzeData(answers) {
      // An√°lise dos dados (simplificada para exemplo)
      const bmi = (answers[5] / ((answers[4]/100) ** 2)).toFixed(1);
      
      let feedback = `<strong>üìä Personalized Health Analysis:</strong><br><br>`;
      feedback += `üßÆ <strong>BMI:</strong> ${bmi} ‚Äî `;
      feedback += bmi >= 30 ? `Obese (‚ö†Ô∏è High risk)<br>` :
                 bmi >= 25 ? `Overweight (‚ö†Ô∏è Moderate risk)<br>` :
                             `Normal (‚úÖ Healthy range)<br>`;
      
      // Adicione mais an√°lises conforme necess√°rio
      
      feedback += `<br>üí¨ <em>This preliminary analysis is based on the information provided. For a comprehensive evaluation, please consult with a healthcare professional.</em>`;
      
      return feedback;
    }

    // Manipulador de envio do chat
    inputForm.addEventListener("submit", function(event) {
      event.preventDefault();
      const userInput = messageInput.value.trim();
      messageInput.value = "";
      if (!userInput) return;

      displayUserMessage(userInput);
      answers.push(userInput);

      // L√≥gica de fluxo do question√°rio
      if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        displayTyping(() => {
          displayAssistantMessage(questions[currentQuestion]);
        });
      } else {
        // Final do question√°rio - mostrar resultados
        displayTyping(() => {
          const analysis = analyzeData(answers);
          displayAssistantMessage(analysis);
          
          // Perguntar se deseja receber por email
          setTimeout(() => {
            displayAssistantMessage("Would you like to receive these results by email? (yes/no)");
            emailRequested = true;
          }, 1000);
        });
      }
    });

    // Configura√ß√£o do formul√°rio de contato
    const contactForm = document.getElementById("contactForm");
    const statusMessage = document.getElementById("statusMessage");

    contactForm.addEventListener("submit", function(e) {
      e.preventDefault();
      
      // Mostrar estado de carregamento
      const submitButton = contactForm.querySelector('button[type="submit"]');
      submitButton.disabled = true;
      submitButton.textContent = "Sending...";
      statusMessage.style.display = "none";

      // Enviar dados do formul√°rio
      fetch("send_email.php", {
        method: "POST",
        body: new FormData(contactForm)
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          statusMessage.textContent = "Thank you! Your message has been sent.";
          statusMessage.className = "status-message success";
          contactForm.reset();
        } else {
          throw new Error(data.error || "Failed to send message");
        }
      })
      .catch(error => {
        statusMessage.textContent = error.message;
        statusMessage.className = "status-message error";
      })
      .finally(() => {
        statusMessage.style.display = "block";
        submitButton.disabled = false;
        submitButton.textContent = "Submit";
      });
    });

    // Tecla Enter para enviar mensagem
    messageInput.addEventListener("keydown", function(e) {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        inputForm.dispatchEvent(new Event("submit"));
      }
    });
  </script>
</body>
</html>
